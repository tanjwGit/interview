## 需搭配简历使用，主要的项目经历的说明

## 与团队分享React、ReactNative常用的性能优化手段和使用经验；包括尽量使用transform实现动画、与UI无关的状态不放进state、props与state的使用误区、长列表的优化、图片压缩、防抖等；？

首先是一些基本的常规方法，
比如class组件通过继承PureComponent进行浅比较 prop 和 state 的方式来避免一些不必要的更新，
因为函数没有实例，每次更新都会返回一个新的组件，但可以使用React.memo 包装成记忆组件，props不发生变化React就会直接复用上一次的渲染结果；
列表时一定要使用稳定的唯一的key,这样React在做diff的时候可以精确识别到时那些列发生了添加、删除、和更新，性能开销更小；



如果没有key时，在列表头部删除或新增了一个元素，会造成整个列表的重新渲染，这个是难以接受的；
还有就是我发现有些同事在使用react的时候，存在一些对react理解方面的误区，
比如不能直接修改props, 曾经有一个线上的数据变化UI没有更新的bug, 有个同事找了一下午都没找出来原因，我当时隔离居家办公我领导就给我打电话说问有没有时间看一下，然后我排查了一下发现就是直接修改了props的数据，虽然数据变化了，但是引用地址没有变化，所以React没有更新UI;
又比如把组件接受的props在生命周期里又放入了state里面等等这些情况;

使用函数组件时，

还有实现动画的时候使用transform，可以避免重新计算布局，重新渲染，如果直接使用元素的几何属性进行动画，代价是十分昂贵的
在机票的双列动画重构时，正是秉持着一个基本的原则和一些其他的优化手段将动画的性能进行了大幅的提高;

压缩图片的话，一般人会觉得能够减少网络传输大小或者减少包的体积，其实这只是其一，还有就是涉及到图片的底层解析加载，一个几十K大小的图片，解码显示时可能就会占用几M的内存；


我发现有些同事，容易有经验主义的错误，比如说他对一个框架很熟悉，当换了一个框架使用的时候，就容易把上一个框架的特性的使用经验拿过来使用，发现不行的时候，会觉得这怎么不行啊?


##	参与制定平台规范，并落地文档说明；包括自定义可配置项数据结构规范、接入方UI组件规范等；
比如一个弹窗、或者提示条等必须作为一个npm包形式的组件，包内部必须含有一个配置文件，这个配置文件声明了自定义的样式配置字段;
平台的详细使用文档；
<!-- 资源位配置 样式配置  整体配置 条件配置 -->
<!-- 前端显示层如何根据配置文件的数据去渲染出一个 -->
<!-- 这个组件打包成功后，就会自动的被配置平台拉取并读取这个配置文件， -->



## 使用React Native的时候都遇到过什么坑？
1. 我们知道React Native的Image组件必须设置宽高才能正常显示；
有次我遇到一个场景，要显示一些图片，这些图片的宽高比不固定，有些宽高比基本时1比1，有些会达到1:7；
后来就直接设置了一个默认的尺寸，获取到图片大小之后在改变Image组件的大小；
然后在安卓上渲染这种宽高比较大的图片的时候就遇到改变Image组件大小之后图片特别模糊，在ios上就显示良好；
我查了很多资料，简单来说就是由于安卓上解码图片的策略导致的，当图片很大，而初始尺寸很小，解码图片时就会减小采样率，然后当我获取到图片真正的尺寸重新设置大小时，并没有重新解码采样图片，
就导致了这种问题；
2. 部分安卓手机使用Text组件显示文字的时候会出现丢失的问题，比如要显示一个价格 100块，他可能就显示成了10块钱;（小米）
我也查了很多资源，比较可信的说法是 有些安卓手机系统内置了一些自己设计的字体，存在一些缺陷导致的这种现象；
这个也通过设置 fontWeight 一定有值 和 fontFamily 为undefined 解决了;（当然不可能把使用的每个Text组件都修改一下，而是重写了Text的render函数）；

3. 虚拟列表使用 getItemLayout 时需要把header的高度也算进去;




自我介绍
我叫 xxx, 本科学历通信工程专业， 目前有接近三年的工作经验，主要的技术栈是react, 曾在两家公司任职，最近 一次经历就职在去哪儿网的机票后服务与前端基础团队担任高级前端工程师的岗位，主要负责国际机票主流程及国内外机票后服务的前端工作，还参与到了node端BFF层的业务工程;


<!-- 因为现在机票业务需求不多，又和酒店 node 同学是一个团队，所以也会做一些 node 端(BFF)的国内酒店主流程业务需求，也算是拓展了一下技术栈，简历中的可视化配置系统 就是我深度参与的一个 Node 项目; -->



团队的规模？
技术栈？
团队负责的业务？

对候选人的期望？
对这个岗位的期望？




FD-87297 修复双列滚动时粘性头部不能正确显示隐藏




机票双列列表

优化项1:
    背景: 每列的前10条数据中, 会有一条数据是推荐报价，但是不确定是哪条，推荐报价的上一条不能显示borderBottom
    原来的实现中， 列表的子组件render函数 使用一个for循环，固定从0 到 10循环，判断本条数据的下一条是否是推荐报价
    这样实现存在的两个问题
    1. 所有列表项都会执行这个for循环
    2. 即使for循环中,i == 0 是推荐报价，但还是会执行剩下的9次循环

    这两条导致代码时间复杂度扩大10倍， 重渲染时很耗费性能


    我的实现: 每项item都有index, 判断 index <= 10 并且index + 1在数组中存在时, 直接从数组中获取 index + 1项 的时候来判断

优化项2:
  背景: 双列表的手势移动动画
  原始实现:

    根据手势的obMove回调的参数存在位移
    使用js根据位移去分别计算每个动画值，比如 列表项的透明度，进度条的缩放、header的偏移
    比如进度条的缩放，是改变 width
    比如列表项的透明度 是每一项设置一个透明度
    比如header偏移时，但是 标题位置不变
    需要更新动画值的子组件实现一个同名的函数，父组件通过ref引用到所有的字组件实例，父组件计算出此刻的动画值后，通过调用子组件内函数的方式来更新;
导致根组件保存了大量的子组件的ref引用;

    以上造成手势移动中js线程需要进行大量的计算，占用系统资源、且react不停的发生setState重渲染、ui线程频繁回流重绘;

    在原实现当中甚至做了一个节流优化:
     使用一个标志变量， 手势每次触发onMove的回调时，就+1, 偶数执行，奇数跳过


    我的实现:
    使用高级 动画操作
    手势移动onMove的回调，直接使用Animated.event()映射出一个动画值，其他使用到的动画，根据映射出的动画值进行插值映射 避免js线程去进行大量的计算任务;
    动画值如果可以设在父元素上就不设置在子元素上，比如列表项的透明度，直接设置到列表容器上
    利用 Transform 实现 平移、缩放、视觉停留(header组件跟随手势左移，但是header内的标题保持与屏幕的相对距离不变);
    使用透明度控制元素的隐藏、避免;
    避免回流重绘


以上 分别在业务逻辑实现、js线程消耗、内存消耗、避免react 重渲染、避免UI线程回流重绘等层面做了优化




###
1. 头脑要清醒，想清楚在说 在写
2. 没有把握写的代码 不要说
3. 灵活一些，可以利用一些发生的事情，虚构出一个设计，但是要有把握才行